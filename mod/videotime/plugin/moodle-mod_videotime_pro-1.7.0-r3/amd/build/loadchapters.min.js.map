{"version":3,"file":"loadchapters.min.js","sources":["../src/loadchapters.js"],"sourcesContent":["/*\n * Load chapters into tab\n *\n * @package    videotimetab_chapter\n * @module     videotimetab_chapter/loadchapters\n * @copyright  2022 bdecent gmbh <https://bdecent.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport VideoTimePlugin from \"mod_videotime/videotime-plugin\";\nimport Notification from \"core/notification\";\nimport Templates from \"core/templates\";\n\nexport default class PreventFastForwarding extends VideoTimePlugin {\n    /**\n     * Initialize the videotime instance with prevent fast forwarding module\n     * @param {VideoTime} videotime\n     * @param {object} instance Prefetched VideoTime instance object.\n     */\n    initialize(videotime, instance) {\n        let player = videotime.getPlayer();\n        player.on('loaded', () => {\n            let container = document.querySelector('#chapter-' + instance.id + ' .videotimetabs_chapters');\n            if (container) {\n                player.getChapters().then(chapters => {\n                    chapters.forEach(chapter => {\n                        let s = Math.floor(Number(chapter.startTime));\n                        if (s >= 3600) {\n                            chapter.starttimedisplay = (Math.floor(s / 3600)).toString().padStart(2, '0') + ':' +\n                                (Math.floor(s % 3600 / 60)).toString().padStart(2, '0') + ':' +\n                                (Math.floor(s % 60)).toString().padStart(2, '0');\n                        } else if (s >= 60) {\n                            chapter.starttimedisplay = (Math.floor(s % 3600 / 60)).toString() + ':' +\n                                (Math.floor(s % 60)).toString().padStart(2, '0');\n                        } else {\n                            chapter.starttimedisplay = (Math.floor(s % 60)).toString();\n                        }\n                        player.addCuePoint(chapter.startTime, {\n                            starttime: chapter.startTime\n                        });\n                    });\n                    Templates.render('videotimetab_chapter/chapters', {\n                        chapters: chapters\n                    }).then(Templates.replaceNodeContents.bind(Templates, container)).fail(Notification.exception);\n                }).catch(Notification.exception);\n            }\n        });\n    }\n}\n"],"names":["PreventFastForwarding","VideoTimePlugin","initialize","videotime","instance","player","getPlayer","on","container","document","querySelector","id","getChapters","then","chapters","forEach","chapter","s","Math","floor","Number","startTime","starttimedisplay","toString","padStart","addCuePoint","starttime","render","Templates","replaceNodeContents","bind","fail","Notification","exception","catch"],"mappings":";;;;;;;;uPAaqBA,8BAA8BC,yBAM/CC,WAAWC,UAAWC,cACdC,OAASF,UAAUG,YACvBD,OAAOE,GAAG,UAAU,SACZC,UAAYC,SAASC,cAAc,YAAcN,SAASO,GAAK,4BAC/DH,WACAH,OAAOO,cAAcC,MAAKC,WACtBA,SAASC,SAAQC,cACTC,EAAIC,KAAKC,MAAMC,OAAOJ,QAAQK,YAE9BL,QAAQM,iBADRL,GAAK,KACuBC,KAAKC,MAAMF,EAAI,MAAOM,WAAWC,SAAS,EAAG,KAAO,IAC3EN,KAAKC,MAAMF,EAAI,KAAO,IAAKM,WAAWC,SAAS,EAAG,KAAO,IACzDN,KAAKC,MAAMF,EAAI,IAAKM,WAAWC,SAAS,EAAG,KACzCP,GAAK,GACgBC,KAAKC,MAAMF,EAAI,KAAO,IAAKM,WAAa,IAC/DL,KAAKC,MAAMF,EAAI,IAAKM,WAAWC,SAAS,EAAG,KAEpBN,KAAKC,MAAMF,EAAI,IAAKM,WAEpDlB,OAAOoB,YAAYT,QAAQK,UAAW,CAClCK,UAAWV,QAAQK,kCAGjBM,OAAO,gCAAiC,CAC9Cb,SAAUA,WACXD,KAAKe,mBAAUC,oBAAoBC,KAAKF,mBAAWpB,YAAYuB,KAAKC,sBAAaC,cACrFC,MAAMF,sBAAaC"}